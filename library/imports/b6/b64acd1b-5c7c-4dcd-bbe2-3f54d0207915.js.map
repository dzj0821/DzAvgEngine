{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\parsers/assets\\Script\\parsers\\SelectCommandParser.ts"],"names":[],"mappings":";;;;;AAAA,mEAA8D;AAC9D,kDAA6C;AAC7C,wDAAmD;AACnD,oDAA+C;AAEzC,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAQ,CAAkB;AAG1C;IAAiD,uCAAsB;IADvE;QAAA,qEA+DC;QAzDG,eAAS,GAAY,KAAK,CAAC;QAE3B,mBAAa,GAAW,EAAE,CAAC;QAE3B,aAAO,GAAa,EAAE,CAAC;;IAqD3B,CAAC;IAnDG,mCAAK,GAAL;QACI,0BAAgB,CAAC,eAAe,CAAC,CAAC,uBAAa,EAAE,wBAAc,CAAC,CAAC,CAAC;IACtE,CAAC;IAED,mCAAK,GAAL,UAAM,WAAW;QACb,QAAO,WAAW,CAAC,OAAO,EAAC;YACvB,KAAK,aAAa;gBACd,IAAG,OAAM,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,WAAW,IAAI,WAAW,CAAC,IAAI,IAAI,EAAE,EAAC;oBACjE,EAAE,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAC;oBACjD,OAAO;iBACV;gBACD,IAAG,IAAI,CAAC,SAAS,EAAC;oBACd,EAAE,CAAC,KAAK,CAAC,2CAA2C,CAAC,CAAC;oBACtD,OAAO;iBACV;gBACD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gBACtB,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC,IAAI,CAAC;gBACtC,MAAM;YACV,KAAK,QAAQ;gBACT,IAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,EAAC;oBAC7B,EAAE,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAC;oBACjD,OAAO;iBACV;gBACD,IAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,EAAC;oBAC7B,EAAE,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;oBAC1C,OAAO;iBACV;gBACD,IAAI,KAAK,GAAG,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBACrC,IAAG,KAAK,IAAI,GAAG,IAAI,KAAK,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAC;oBACpE,EAAE,CAAC,KAAK,CAAC,mCAAmC,CAAC,CAAC;oBAC9C,OAAO;iBACV;gBACD,IAAG,CAAC,IAAI,CAAC,SAAS,EAAC;oBACf,EAAE,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;oBAC9B,OAAO;iBACV;gBACD,EAAE,CAAC,GAAG,CAAC,OAAO,WAAW,CAAC,IAAI,CAAC,CAAC;gBAChC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,WAAW,CAAC,IAAI,CAAC;gBACvC,MAAM;YACV,KAAK,WAAW;gBACZ,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACvB,uBAAa,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;gBACrE,OAAO;SACd;QACD,wBAAc,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;IACnC,CAAC;IAED,oCAAM,GAAN,UAAO,KAAK;QACR,OAAO,OAAM,CAAC,KAAK,CAAC,IAAI,WAAW,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,IAAI,EAAE,CAAC;IACzE,CAAC;IAvDD;QAHC,QAAQ,CAAC;YACN,OAAO,EAAE,KAAK;SACjB,CAAC;0DACyB;IALV,mBAAmB;QADvC,OAAO;OACa,mBAAmB,CA8DvC;IAAD,0BAAC;CA9DD,AA8DC,CA9DgD,gCAAsB,GA8DtE;kBA9DoB,mBAAmB","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\parsers","sourcesContent":["import CommandParserInterface from \"./CommandParserInterface\";\r\nimport SelectManager from \"../SelectManager\";\r\nimport ManagerInterface from \"../ManagerInterface\";\r\nimport ContentManager from \"../ContentManager\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class SelectCommandParser extends CommandParserInterface {\r\n\r\n    @property({\r\n        visible: false,\r\n    })\r\n    selecting: boolean = false;\r\n\r\n    selectVarName: string = \"\";\r\n\r\n    selects: string[] = [];\r\n\r\n    start () {\r\n        ManagerInterface.managersIsExist([SelectManager, ContentManager]);\r\n    }\r\n\r\n    parse(jsonMessage) {\r\n        switch(jsonMessage.Command){\r\n            case \"SelectStart\":\r\n                if(typeof(jsonMessage.Arg1) == \"undefined\" || jsonMessage.Arg1 == \"\"){\r\n                    cc.error(\"SelectStart命令应设置Arg1一个变量名用来存储玩家选择的选项\");\r\n                    return;\r\n                }\r\n                if(this.selecting){\r\n                    cc.error(\"SelectStart已经执行过，是否上个Select忘记执行SelectEnd？\");\r\n                    return;\r\n                }\r\n                this.selecting = true;\r\n                this.selectVarName = jsonMessage.Arg1;\r\n                break;\r\n            case \"Select\":\r\n                if(this.isNull(jsonMessage.Arg1)){\r\n                    cc.error(\"SelectStart命令应设置Arg1一个变量名用来存储玩家选择的选项\");\r\n                    return;\r\n                }\r\n                if(this.isNull(jsonMessage.Text)){\r\n                    cc.error(\"SelectStart命令应设置Text作为选项显示的文本\");\r\n                    return;\r\n                }\r\n                let value = Number(jsonMessage.Arg1);\r\n                if(value == NaN || value % 1 !== 0 || !this.isNull(this.selects[value])){\r\n                    cc.error(\"参数不合法：Select的Arg1应该是所有选项中的一个唯一的整数\");\r\n                    return;\r\n                }\r\n                if(!this.selecting){\r\n                    cc.error(\"尚未执行SelectStart命令\");\r\n                    return;\r\n                }\r\n                cc.log(typeof jsonMessage.Arg1);\r\n                this.selects[value] = jsonMessage.Text;\r\n                break;\r\n            case \"SelectEnd\":\r\n                this.selecting = false;\r\n                SelectManager.instance.showSelects(this.selectVarName, this.selects);\r\n                return;\r\n        }\r\n        ContentManager.instance.next();\r\n    }\r\n\r\n    isNull(value): boolean{\r\n        return typeof(value) == \"undefined\" || value === null || value == \"\";\r\n    }\r\n\r\n}\r\n"]}